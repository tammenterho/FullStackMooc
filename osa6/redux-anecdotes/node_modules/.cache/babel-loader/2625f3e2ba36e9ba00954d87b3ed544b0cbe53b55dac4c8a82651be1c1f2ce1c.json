{"ast":null,"code":"\"use strict\";\n\nconst fs = require('fs');\nconst path = require('path');\nconst express = require('express');\nconst logger = require('morgan');\nconst cors = require('cors');\nconst compression = require('compression');\nconst errorhandler = require('errorhandler');\nconst bodyParser = require('./body-parser');\nmodule.exports = function (opts) {\n  const userDir = path.join(process.cwd(), 'public');\n  const defaultDir = path.join(__dirname, '../../public');\n  const staticDir = fs.existsSync(userDir) ? userDir : defaultDir;\n  opts = Object.assign({\n    logger: true,\n    static: staticDir\n  }, opts);\n  const arr = []; // Compress all requests\n\n  if (!opts.noGzip) {\n    arr.push(compression());\n  } // Enable CORS for all the requests, including static files\n\n  if (!opts.noCors) {\n    arr.push(cors({\n      origin: true,\n      credentials: true\n    }));\n  }\n  if (process.env.NODE_ENV === 'development') {\n    // only use in development\n    arr.push(errorhandler());\n  } // Serve static files\n\n  arr.push(express.static(opts.static)); // Logger\n\n  if (opts.logger) {\n    arr.push(logger('dev', {\n      skip: req => process.env.NODE_ENV === 'test' || req.path === '/favicon.ico'\n    }));\n  } // No cache for IE\n  // https://support.microsoft.com/en-us/kb/234067\n\n  arr.push((req, res, next) => {\n    res.header('Cache-Control', 'no-cache');\n    res.header('Pragma', 'no-cache');\n    res.header('Expires', '-1');\n    next();\n  }); // Read-only\n\n  if (opts.readOnly) {\n    arr.push((req, res, next) => {\n      if (req.method === 'GET') {\n        next(); // Continue\n      } else {\n        res.sendStatus(403); // Forbidden\n      }\n    });\n  } // Add middlewares\n\n  if (opts.bodyParser) {\n    arr.push(bodyParser);\n  }\n  return arr;\n};","map":{"version":3,"names":["fs","require","path","express","logger","cors","compression","errorhandler","bodyParser","module","exports","opts","userDir","join","process","cwd","defaultDir","__dirname","staticDir","existsSync","Object","assign","static","arr","noGzip","push","noCors","origin","credentials","env","NODE_ENV","skip","req","res","next","header","readOnly","method","sendStatus"],"sources":["C:/FullStackMooc/osa6/redux-anecdotes/node_modules/json-server/lib/server/defaults.js"],"sourcesContent":["\"use strict\";\n\nconst fs = require('fs');\n\nconst path = require('path');\n\nconst express = require('express');\n\nconst logger = require('morgan');\n\nconst cors = require('cors');\n\nconst compression = require('compression');\n\nconst errorhandler = require('errorhandler');\n\nconst bodyParser = require('./body-parser');\n\nmodule.exports = function (opts) {\n  const userDir = path.join(process.cwd(), 'public');\n  const defaultDir = path.join(__dirname, '../../public');\n  const staticDir = fs.existsSync(userDir) ? userDir : defaultDir;\n  opts = Object.assign({\n    logger: true,\n    static: staticDir\n  }, opts);\n  const arr = []; // Compress all requests\n\n  if (!opts.noGzip) {\n    arr.push(compression());\n  } // Enable CORS for all the requests, including static files\n\n\n  if (!opts.noCors) {\n    arr.push(cors({\n      origin: true,\n      credentials: true\n    }));\n  }\n\n  if (process.env.NODE_ENV === 'development') {\n    // only use in development\n    arr.push(errorhandler());\n  } // Serve static files\n\n\n  arr.push(express.static(opts.static)); // Logger\n\n  if (opts.logger) {\n    arr.push(logger('dev', {\n      skip: req => process.env.NODE_ENV === 'test' || req.path === '/favicon.ico'\n    }));\n  } // No cache for IE\n  // https://support.microsoft.com/en-us/kb/234067\n\n\n  arr.push((req, res, next) => {\n    res.header('Cache-Control', 'no-cache');\n    res.header('Pragma', 'no-cache');\n    res.header('Expires', '-1');\n    next();\n  }); // Read-only\n\n  if (opts.readOnly) {\n    arr.push((req, res, next) => {\n      if (req.method === 'GET') {\n        next(); // Continue\n      } else {\n        res.sendStatus(403); // Forbidden\n      }\n    });\n  } // Add middlewares\n\n\n  if (opts.bodyParser) {\n    arr.push(bodyParser);\n  }\n\n  return arr;\n};"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}